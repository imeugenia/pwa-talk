<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>PWA</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/pwa-talk.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h2>Game over, Downasaur, PWA are winning!</h2>
					<aside class="notes">
						Hello! I will speak about PWA today.
					</aside>
				</section>
				<section style="text-align: left">
					I'm Jevgenija
					<hr>
					Web developer @N26 üë©‚Äçüíª <br>
					Google Developer Group organizer üéâ<br>
					Women TechMakers lead in Latvia üá±üáª
					<aside class="notes">

					</aside>
				</section>
				<section>
					<img src="images/downasaur.png" />
					<aside class="notes">
						> will kill this cute offline downasaur. <br>
						> users will always see your web page or web app <br>
						> if it is a Progressive Web App.
					</aside>
				</section>
				<section>
					<h3>Our plan</h3>
					<ol>
						<li>PWA: Why? What? How?</li>
						<li>Service Worker: caching and much more</li>
						<li>Firestore for PWA</li>
						<li>Demo</li>
					</ol>
					<aside class="notes">
						> not only about visually displaying when offline. <br>
						> more fundamental ideas beneath PWA. <br>
						> I will try to answer questions why? what? how?
					</aside>
				</section>
				 <!-- Why do we need it? -->
				<section>
					<img src='./images/mobile-web-reach.png' alt='' />
					<span class="source">Source: <a href='https://www.youtube.com/watch?v=m-sCdS0sQO8'>Progressive Web Apps: Great Experiences Everywhere</a></span>
					<aside class="notes">
						Why do we need to bring PWA to the Web? <br>
						> The lovely part about Web is it's wide audience. <br>
						> Statistically websites reach more people than apps.
					</aside>
				</section>
				<section>
					<img src='./images/mobile-web-engagement.png' alt='' />
					<span class="source">Source:
						<a href='https://www.youtube.com/watch?v=m-sCdS0sQO8'>Progressive Web Apps: Great Experiences Everywhere</a>
					</span>
					<aside class="notes">
						> but they usually quickly quit. <br>
						> native app‚Äîcontinue using it for a long time. <br>
						> disputable: average we use about only 10 apps per day.
					</aside>
				</section>
				<section style="text-align: center">
					<span>Wide reach + Engagement = PWA</span>
					<aside class="notes">
						 > The main idea around PWA ‚Äî combine the best parts of web and native apps, <br>
						 > wide reach of audience and big user engagement. <br>
						 > There are a lot of thing below making user engagement better.
					</aside>
				</section>
				<!-- Main characteristics -->
				<section>
					<h1>4 main characteristics</h1>
					<aside class="notes">
						We can speak about PWA a lot. Today I will focuse on 4 main characteristics.
					</aside>
				</section>
				<section>
					<h3>1. Works offline</h3>
					<img style="height: 4rem" src="/images/wifi-off.svg" alt="" />
					<aside class="notes">
						It can provide web page UI even in poor or no internet connection.
					</aside>
				</section>
				<section data-background-color="#ffffff">
					<h4>2. Behaves like a native app</h4>
					<img src="https://www.androidpolice.com/wp-content/uploads/2017/02/nexus2cee_ezgif.com-38a8758ebf.gif" />
					<span class="source">Source: <a href="https://airhorner.com/">Air Horner</a></span>
					<aside class="notes">
						PWA engages users by
						<ul>
							<li>providing easy installation</li>
							<li>homescreen icon</li>
							<li>splash screen</li>
							<li>instant loading</li>
							<li>Push notifications</li>
							<li>and many other things that nativa apps do</li>
						</ul>
					</aside>
				</section>
				<!-- Add to homescreen -->
				<section style="text-align: center">
					<img style="width: 30%" src='./images/add-homescreen.png' alt='' />
					<aside class="notes">
						If you use Chrome it will look like this. We can add icon to homescreen in one click. <br>
						> this is how the app is installed
					</aside>
				</section>
				<!-- App Manifest -->
				<section style="text-align: center">
					<img style="width: 30%" src='./images/splash-screen.png' alt='' />
					<aside class="notes">
						> When we open => see a splash screen => common for native apps. <br>
						> appears before the content is loaded. <br>
						> with help of Web App Manifest.
					</aside>
				</section>
				<section data-background-color="#ffffff">
					Web App Manifest
					<img style="width: 60%" src='./images/manifest.png' alt='' />
					<aside class="notes">
						> simple JSON file <br>
						> helps to control how app appears. <br>
						> important member ‚Äî "display" which describes how app window will
						look. <br>
						> If "standalone" the application will look and feel like a native, <br>
						> having a different window, <br>
						> its own icon in the application launcher, etc. <br>
						> is launched by browser, but browser's UI not displayed.
					</aside>
				</section>
				<section>
					<h3 style="display: inline; margin-right: 1rem">3. Is fast</h3>
					<img style="height: 1em" src="images/fast_parrot.gif" alt="">
					<aside class="notes">
						 PWA loads fast. Let's discuss how.
					</aside>
				</section>
				<!-- App Shell -->
				<section data-background-color="#ffffff">
					<span>App Shell</span>
					<img src="https://developers.google.com/web/fundamentals/architecture/images/appshell.png"/>
					<span class="source">Source:<a href="https://developers.google.com/web/fundamentals/architecture/app-shell">Google Developers</a></span>
					<aside class="notes">
						By implementing App Shell. <br>
						> minimal HTML, CSS, and JavaScript for providing basic user interface. <br>
						> Cache it => app shell appeares quickly before dynamic content arrives.
					</aside>
				</section>
				<section>
					<h3>4. Is secure</h3>
					<img src='./images/https.svg' alt='' />
					<span>https://</span>
					<aside class="notes">
						It work only with https. <br>
						> because of..
					</aside>
				</section>

				<!-- How it works? -->
				<section>

					<h2 style="display: inline-block; margin-right:1rem">Service Worker</h2>
					<img id="sw-icon" style="height: 1em" src="images/work.svg" />
					<img style="height: 1em" src="images/javascript.png" alt="">
					<aside class="notes">
						Service worker <br>
						> Logic responsible for offline work, <br>
						> fast loading, <br>
						> push notifications and so on ==> is handled by SW. <br>
						> It is a JavaScript file.
					</aside>
				</section>
				<section>
					<img src='./images/offline-first-diagram.png' alt=''/>
					<aside class="notes">
						> acts like a middleware between client and server. <br>
						> when is registered and files (html, css, js, images etc.) are cached, <br>
						> no internet connection => get's response from cache <br>
						> if online => from a server <br>
						> but there are different caching strategies
					</aside>
				</section>
				<section>
						<h3>=> Controls network requests</h3>
						<aside class="notes">
							It's main function is catch and handle network requests.
						</aside>
				</section>
				<section data-background-color="#ffffff">
					<span>Wait.. but there was AppCache</span><img style="margin-left: 1em" src="images/spongebobwtf.jpg" alt="">
					<aside class="notes">
						> someone might say there is nothing new <br>
						> because of AppCache. That allowed you to cache
						your website files and display them offline. <br>
						> Not the same at all <br>
						> SW is more low-level. <br>
						> More control over your app.
					</aside>
				</section>
				<section>
					<h3>Is asyncronous by nature</h3>
					<aside class="notes">
						> a lot Promises in SW syntax, <br>
						> all methods are asyncronous. <br>
						> Run on background <br>
						> What does that mean? <br>
						> When a web page is parsed by a browser => one main thread. <br>
						> SW is on different thread <br>
						> Not blocking performance of the website. <br>
					</aside>
				</section>
				<section>
					<h3>=> Can't access DOM directly</h3>
					<aside class="notes">
						> But it also can't access DOM directly. <br>
						> SW is running in a different context.
					</aside>
				</section>

				<section>
					<h3 style="display: inline; margin-right: 1rem">Is it Web Worker</h3>
					<img style="height: 1.5em" src="images/question.gif" alt="">
					<aside class="notes">
						> yes, but not really. <br>
						> different architecture <br>
						> WW ‚Äî interface for running CPU consuming code like client-side encryption or calculations for animation. This code will run on a separate thread and will not block executing of the rest of the code. <br>
						> SW - kind of WW <br>
						> but...
					</aside>
				</section>
				<section>
					<h3>Event-driven</h3>
					<aside class="notes">
						You can handle logic by listening events.
					</aside>
				</section>
				<section>
					<h3>Lives by it's own lyfecycle</h3>
					<aside class="notes">
						SW undergoes certain steps before it starts it's main work
					</aside>
				</section>
				<section>
					Regiter => Install => Activate
					<aside class="notes">
						This steps include registering SW, installing and activation it.
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					 1. Register
					<img src="images/register-0.png" alt="">
					<aside class="notes">
						> First ‚Äî register SW. <br>
						> in main js file <br>
						> Check if it exists in WorkerGlobalScope <br>
						> i.e is it supported? <br>
						> check if page loaded.
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					1. Register
					<img src="images/register-1.png" alt="">
					<aside class="notes">
						> Call register method <br>
						> give a path to SW file
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					1. Register
					<img src="images/register-2.png" alt="">
					<aside class="notes">
						> it returns a promise, <br>
						> use then() to wait until registration is finished <br>
						> and show a message in console for instance.
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					1. Register
					<img src="images/register-3.png" alt="">
					<aside class="notes">
						> We can handle error<br>
						> IMPORTANT: where you locate sw.js, <br>
						> if not in a root ‚Äî it control requests and responses
						only in a scope it is located.
					</aside>
				</section>
				<section data-background-color="#ffffff">
					2. Listen to 'install' event
					<img src='./images/install-0.png' alt='' />
					<aside class="notes">
						> installation state. <br>
						> main thing to handle ‚Äî caching all files we want for
						offline. <br>
						> We name our cache, list all urls <br>
						> add install event listener.
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					2. Listen to 'install' event
					<img src='./images/install-1.png' alt='' />
					<aside class="notes">
						We want install event to wait until we do everything we need.
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					2. Listen to 'install' event
					<img src='./images/install-2.png' alt='' />
					<aside class="notes">
						We create cache with defined name..
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					2. Listen to 'install' event
					<img src='./images/install-3.png' alt='' />
					<aside class="notes">
						..and add all listed files in cache. <br> And we are ready to go to..
					</aside>
				</section>
				<section data-background-color="#ffffff">
					3. Listen to 'activate' event
					<img style="width: 80%;" src='./images/activate-0.png' alt='' />
					<aside class="notes">
						..activativation state. <br>
						> good time to clean up old caches and keep wep app up to date. <br>
						> We want to change the key of our cache.
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					3. Listen to 'activate' event
					<img style="width: 80%;" src='./images/activate-1.png' alt='' />
					<aside class="notes">
						We look for cache keys
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					3. Listen to 'activate' event
					<img style="width: 80%;" src='./images/activate-2.png' alt='' />
					<aside class="notes">
						Use Promise.all() method, because..
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					3. Listen to 'activate' event
					<img style="width: 80%;" src='./images/activate-3.png' alt='' />
					<aside class="notes">
						We are mapping all cache keys and..
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					3. Listen to 'activate' event
					<img style="width: 80%;" src='./images/activate-4.png' alt='' />
					<aside class="notes">
						checking if key matches our new cacheName.
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					3. Listen to 'activate' event
					<img style="width: 80%;" src='./images/activate-5.png' alt='' />
					<aside class="notes">
						if not we delete this cache. <br>
						> example simple, but here we can compare files for caching <br>
						> to clean up what needed
					</aside>
				</section>
				<section data-background-color="#ffffff">
					'fetch' event
					<img src='./images/fetch-0.png' alt='' />
					<aside class="notes">
						> SW is active <br>
						> starts to receive fetch events. <br>
						> Here we control requests and responses.
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					'fetch' event
					<img src='./images/fetch-1.png' alt='' />
					<aside class="notes">
						> event fires when url is requested <br>
						> We take url => check if it matches whith cache
					</aside>
				</section>
				<section style="transition: none" data-background-color="#ffffff">
					'fetch' event
					<img src='./images/fetch-2.png' alt='' />
					<aside class="notes">
						> if match => respond with a file from
						cache, <br>
						> if not => use fetch method for network request.
						> Abstract example <br>
						> We can do more, for example, adding new files to cache, generate our own responses.
					</aside>
				</section>
				<section>
					<span>Cool, we can do offline-first! </span>
					<img style="height: 2em" src='images/spinner.gif' />
					<aside class="notes">
						Cool, we know: <br>
						> web app manifest <br>
						> app shell <br>
						> caching with SW <br>
						> but this is a small part
					</aside>
				</section>
				<!-- IndexedDB -->
				<section data-background-color="#ffffff">
					<img src='images/homer_thinking.png' />
					<h4>Where should offline data be stored?</h4>
					<aside class="notes">
						> some data to store not in cache. WHERE? <br>
						> there is browser storage <br>
						> By design SW hasn't access to localStorage, <br>
						> but it can use IndexedDB API.
					</aside>
				</section>
					<section>
						<span>IndexedDB</span>
						<img src="images/indexeddb.png" alt="">
						<aside class="notes">
							> client-side storage for big amounts of structured data.<br><br>
							> data is stored by key/value pairs <br>
							> we have offline PWA <br>
							> users can add some data <br>
							> store it in IndexedDB <br>
						</aside>
					</section>
				<!-- Additional features -->
				<section>
					<span>How to syncronize data?</span>
					<span style="position: absolute; font-size: 3em; top: 1em; right: 1em;">ü§∑‚Äç</span>
					<img style="width: 60%; margin-top: 1em;" src="images/sync-problem.jpg" alt="" />
					<aside class="notes">
						> But we want to have DB on server <br>
						> how to syncronize data with it?
					</aside>
				</section>
				<!-- Background syncronization -->
				<section data-background-color="#ffffff">
					<h3>Web Background synchronization</h3>
					<aside class="notes">
						> use Web BG sync API <br>
						> basic concept ‚Äî when we want data to be sync we fire sync event <br>
						> Event is qeued if no connection <br>
						> when online ‚Äî SW listens to this event <br>
						> Sync event fires when the browser goes from an offline state to an online state. <br>
						> How to code this?
					</aside>
				</section>
				<section data-background-color="#ffffff">
					main.js
					<img src="images/sync-0.png" alt="" />
					<aside class="notes">
						> In main js file <br>
						> SW registration and it is ready <br>
						> we can register a sync event and give it a tag. <br>
						> events can be for different purposes - we don't want to mis them <br>
						> Register === create a sync event. <br>
						> can be done on UI level, on button click for instance
					</aside>
				</section>
				<section data-background-color="#ffffff">
					sw.js
					<img src="images/sync-1.png" alt="" />
					<aside class="notes">
						> event listener for sync event <br>
						> check if sync event that we need <br>
						> and run method with syncronization logic <br>
						> which can fetch something that we need or send data to the server.
					</aside>
				</section>
				<section>
					Background sync event support
					<img src="images/background-sync-support.png" alt="" />
					<aside class="notes">
						> supported only by Chrome. <br>
						> other hacky ways how to manage it.
						<br><br>
						// In case of questions answer this:
						There is a Push API, where you can send a push event from server to SW to let it know that something changed on the server.
						And you can use postMessage() method that allows to send message to SW and let it know that something changed on client side and it needs to be syncronized with the server.
					</aside>
				</section>
				<!-- Firestore -->
				<section style="text-align: center">
					<h3>Cloud Firestore</h3>
					<img src='./images/firestore-logo.svg' />
					<aside class="notes">
						> Speaking about data and manipulating data. <br>
						> need a database for this. <br>
						> Cloud Firestore. I suggest for PWA.
						<br/>
						> from Firebase and Google Cloud platform. <br>
						> flexible, scalable, easy in querying data. <br>
						> super useful at least for 2 reasons.
					</aside>
				</section>
				<section>
					<h3>Why Firestore?</h3>
					<ol>
						<li>Realtime updates</li>
						<li>Offline support</li>
					</ol>
					<aside class="notes">
						> Realtime updates ‚Äî user data will be synchronized across all connected devices. <br>

						> offline support ‚Äî caches data, so the app can write, read, listen to, and query data <br>
						> When online ‚Äî synchronizes any local changes <br>
						> add API and Firestore library will handle that logic. <br>
						> still in BETA, but let's see what will be announced on Google I/O
					</aside>
				</section>
				<section style="text-align: center">
					<h3>How to get started?</h3>
					<ol>
						<li>Create a project in Firebase console</li>
						<li>Enable Firestore</li>
					</ol>
					<aside class="notes">

					</aside>
				</section>
				<section data-background-color="#ffffff">
					<img src='./images/firestore-start.png' />
					<aside class="notes">
						> friendly for frontend developers. <br>
						> import Firebase modules, <br>
						> initialize your firebase app and firestore database. <br>
						> start querying, setting or deleting data.
					</aside>
				</section>
				<section data-background-color="#ffffff">
					<span>Let's see how it works!</span>
					<img style="margin-left: 1rem" src="images/challenge_accepted.jpg" alt="">
					<aside class="notes">
						<a href="https://docs.google.com/document/d/136xYv7npx-ZtUerMwgKeEvnizQOqmuLsPXHTBrIvqz4/edit?usp=sharing">Text for demonstration</a>

					</aside>
				</section>
				<section style="text-align: left" data-background-color="#ffffff">
					<h4>Useful tools/libraries</h4>
					<hr>
					<ul style="margin: 0">
						<li>Lighthouse</li>
						<li>Workbox</li>
						<li>sw-precache</li>
						<li>sw-toolbox</li>
						<li>Create React App</li>
						<li>Offline Google Analytics</li>
						<li>PRPL pattern</li>
					</ul>
					<aside class="notes">
						<ol>
							<li><strong>Lighthouse</strong>‚Äî a tool for testing if your app match PWA criteria. It also tests UX and performance of your app</li>
							<li><strong>Workbox</strong>‚Äî a library for easy caching of assets</li>
							<li><strong>sw-precache</strong>‚Äî a tool that will generate a SW for you</li>
							<li><strong>sw-toolbox</strong>‚Äî a library that will help to perform a caching strategy within a SW. There are 5 most common cache strategies already implemented in the library</li>
							<li><strong>Create React App</strong>‚ÄîSW is already there by default. I used it in demo project</li>
							<li><strong>Offline Google Analytics</strong>‚Äîit's possible to collect analytics data even offline!</li>
							<li><strong>PRPL pattern</strong>‚Äî I suggest you to take a look on PRPL pattern for building a PWA. It provide set of techniques that make performance and caching efficiency better to achieve minimum time-to-interactive. This approach includes App Shell, Http/2 server push method.</li>
						</ol>
					</aside>
				</section>
				<section data-background-color="#ffffff">
					 https://outweb.io/
					<div>
						<img style="width: 15%" src="images/twitter.gif" alt="">
						<img style="width: 20%" src="images/alibaba.gif" alt="">
						<img style="width: 20%" src="images/aliexpress.gif" alt="">
						<img style="width: 15%" src="images/tinder.png" alt="">
					</div>
					<aside class="notes">

					</aside>
				</section>
				<section>
					<div style="color: #ff6f56">Jevgenija Zigisova</div>
					<div>@jevgeniazi</div>
					<div style="text-decoration: underline">imeugenia.com</div>
					<aside class="notes">
						Feel free to contact me! Btw I have offline dinasaur stickers.
					</aside>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
